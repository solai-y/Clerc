<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AI Tagging Demo</title>
    <style>
      body { font-family: system-ui, sans-serif; max-width: 680px; margin: 2rem auto; }
      h1 { margin-bottom: 1rem; }
      .err { color: #b00020; }
      .ok { color: #006400; }
      .row { margin: .5rem 0; }
    </style>
  </head>
  <body>
    <h1>Upload PDF â†’ Tags</h1>
    <div class="row">
      <input id="file" type="file" accept="application/pdf" />
      <button id="go">Upload & Tag</button>
    </div>
    <pre id="out"></pre>

    <script>
      const out = document.getElementById('out');
      document.getElementById('go').onclick = async () => {
        out.textContent = 'Working...';
        const f = document.getElementById('file').files[0];
        if (!f) { out.textContent = 'Choose a PDF first.'; return; }
        const fd = new FormData(); fd.append('pdf', f);
        try {
          const r = await fetch('/ai/v1/predict?top_k=5', { method:'POST', body: fd });
          const j = await r.json();
          if (!r.ok) throw new Error(JSON.stringify(j));
          out.textContent = `${j.filename}\n\n` + j.tags.map(t => `${t.tag} ${(t.score*100).toFixed(1)}%`).join('\n');
        } catch (e) {
          out.textContent = 'Error: ' + e.message;
        }
      };
    </script>
  </body>
</html>
